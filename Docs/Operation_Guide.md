# Microsoft製品運用自動化ツール 運用ガイド

## 1. 概要
本運用ガイドは、Microsoft 365および関連サービスの管理業務を自動化するためのツール運用について説明します。

## 2. 日常運用
### 2.1. スケジュール化されたタスクの監視
タスクスケジューラなどで設定された自動実行ジョブの監視方法について説明します。

### 2.2. ログファイルの確認
定期的にログファイルをチェックし、問題が発生していないか確認します。
- 実行ログ: `Logs/RunLogs/`
- エラーログ: `Logs/ErrorLogs/`
- 監査ログ: `Logs/AuditLogs/`

## 3. エラー発生時の対応
### 3.1. エラーログの分析
エラーが発生した場合、エラーログを確認し、エラーメッセージとスタックトレースから原因を特定します。

### 3.2. 修正手順
一般的なエラーに対する修正手順や、サポートへのエスカレーションパスを定義します。

## 4. レポートの活用
### 4.1. レポートの確認と配布
生成された各種レポート（日次、週次、月次、年次）の確認方法と関係部門への配布手順について説明します。

### 4.2. データ分析と改善
レポートデータを活用して、運用の効率化やセキュリティ強化のための改善策を検討します。

## 5. 定期的なメンテナンス
### 5.1. モジュール更新
各PowerShellモジュールの定期的な更新手順について説明します。

### 5.2. 設定ファイルの管理
`Config/config.json`および`Config/secrets.enc.json`のバックアップ、更新、暗号化解除/再暗号化の手順について説明します。

### 5.3. ログのアーカイブと削除
古いログファイルのアーカイブと削除手順について説明します。

## Active Directory PowerShellリモート管理の注意点

- ADWS (Active Directory Web Services) を起動する際は、必ず管理者権限でPowerShellを実行してください。権限不足により接続エラーが発生する場合があります。
- RSAT (Remote Server Administration Tools) の導入はWindowsのバージョンに依存します。Windows 10/11のバージョンに応じたRSATのインストールを行ってください。
- よくあるエラー例と対処法の具体例は、`Docs/Active Directory PowerShellリモート管理・操作 詳細手順書.txt` を参照してください。
- リモートコマンドの実行例は表記を統一しており、以下の形式を推奨しています。

```powershell
Invoke-Command -ComputerName <サーバー名> -ScriptBlock { <コマンド> }
```